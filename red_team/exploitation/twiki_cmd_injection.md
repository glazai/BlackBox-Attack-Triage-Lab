# TWiki Command Injection (CVE-2005-2877) – Attempted Exploitation

# Objective

Attempt to exploit a known command injection vulnerability in TWiki's `view` script via the `rev` parameter, aiming to gain remote shell access on the target (Metasploitable2) using Metasploit.

---

# Vulnerability Summary

- **CVE:** CVE-2005-2877
- **Service:** TWiki Web Interface
- **Affected URI:** `/twiki/bin/view/Main/`
- **Issue:** Unsanitized input in the `rev` parameter allows command injection.
- **Exploit Module:** `exploit/unix/webapp/twiki_history`
- **MITRE ATT&CK Mapping:**
  - **T1190** – Exploit Public-Facing Application
  - **T1059.004** – Command and Scripting Interpreter: Unix Shell

---

# Exploit Configuration

- **Target IP:** `192.168.6.3`
- **Attacker IP (Kali):** `192.168.6.4`
- **LPORT:** Tested with `4448`, `4449`, `4450`
- **Payloads Tried:**
  - `cmd/unix/reverse`
  - `cmd/unix/reverse_netcat`
  - `cmd/unix/reverse_perl`
- **LHOST Binding:** Tried both `0.0.0.0` and specific IP
- **Target Path:** `/twiki` (default)

---

# Result

- Exploit successfully sent:
[+] Successfully sent exploit request
[*] Exploit completed, but no session was created.
- No shell received on any LPORT or payload.
- Reverse connection from target to attacker failed in every case.

# Diagnosis

- TWiki interface is accessible and appears functional.
- The injected commands may not be executed:
- Outdated Metasploit module behavior
- Payload incompatibility or Netcat not present on target
- Target environment fails silently on malformed Perl/PHP payloads
- Confirmed that Metasploitable2 can ping Kali; no firewall issues observed.


# Outcome

Exploit is marked as **unsuccessful**. No RCE achieved. However, the module was tested responsibly with a variety of payloads, network bindings, and listener setups.


